{% extends 'base_auth.html' %}
{% load static %}

{% block title %}Login{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/login_new.css' %}">
{% endblock %}

{% block card_class %}login-card{% endblock %}
{% block header_class %}login-header{% endblock %}
{% block icon_class %}login-icon{% endblock %}
{% block title_class %}login-title{% endblock %}
{% block subtitle_class %}login-subtitle{% endblock %}

{% block icon %}sign-in-alt{% endblock %}
{% block page_title %}Welcome Back!{% endblock %}
{% block page_subtitle %}Sign in to continue your academic journey{% endblock %}

{% block content %}
<form method="post" novalidate id="loginForm">
    {% csrf_token %}
    
    <!-- Username/Email Field -->
    <div class="form-field">
        <label for="id_username">Email or Student ID</label>
        <div class="input-wrapper">
            <input 
                type="text" 
                name="username" 
                id="id_username" 
                class="{% if form.username.errors %}error{% endif %}"
                value="{{ form.username.value|default:'' }}"
                placeholder="your.email@cit.edu or 12-3456-789"
                required
            >
            {% if form.username.errors %}
            <i class="fas fa-exclamation-circle validation-icon error"></i>
            <div class="validation-tooltip">{{ form.username.errors.0 }}</div>
            {% endif %}
        </div>
    </div>
    
    <!-- Password Field -->
    <div class="form-field">
        <label for="id_password">Password</label>
        <div class="password-field-wrapper">
            <input 
                type="password" 
                name="password" 
                id="id_password" 
                class="{% if form.password.errors %}error{% endif %}"
                required
                placeholder="••••••••"
            >
            <button type="button" class="toggle-password-btn" id="togglePassword">
                <img src="{% static 'svgs/basil--eye-outline.svg' %}" alt="Show password" id="eyeIcon">
            </button>
            {% if form.password.errors %}
            <i class="fas fa-exclamation-circle validation-icon error"></i>
            <div class="validation-tooltip">{{ form.password.errors.0 }}</div>
            {% endif %}
        </div>
    </div>
    
    <!-- Non-field errors (invalid credentials) -->
    {% if form.non_field_errors %}
    <div class="error-message">
        <i class="fas fa-exclamation-triangle"></i>
        {{ form.non_field_errors.0 }}
    </div>
    {% endif %}
    
    <!-- Submit Button -->
    <button type="submit" class="submit-btn">
        <i class="fas fa-sign-in-alt"></i> Sign In
    </button>
</form>

<!-- Register Link -->
<div class="register-link">
    Don't have an account? <a href="{% url 'accounts:register' %}">Create one now</a>
</div>

<!-- Back to Home -->
<div class="back-link">
    <a href="{% url 'home' %}">
        <i class="fas fa-arrow-left"></i> Back to Home
    </a>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Password toggle functionality
    const togglePassword = document.getElementById('togglePassword');
    const passwordInput = document.getElementById('id_password');
    const eyeIcon = document.getElementById('eyeIcon');
    
    if (togglePassword && passwordInput && eyeIcon) {
        togglePassword.addEventListener('click', function() {
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            
            // Toggle eye icon
            if (type === 'text') {
                eyeIcon.src = "{% static 'svgs/basil--eye-solid.svg' %}";
            } else {
                eyeIcon.src = "{% static 'svgs/basil--eye-outline.svg' %}";
            }
        });
    }
</script>
{% endblock %}


