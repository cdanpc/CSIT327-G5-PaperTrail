{% extends 'base_dashboard.html' %}
{% load static %}

{% block title %}Flashcards - My Decks{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/flashcards.css' %}">
{% endblock %}

{% block header %}
<div class="dashboard-title-section">
    <h1 class="dashboard-title">My Flashcard Decks</h1>
    <p class="dashboard-date">Create decks and study with interactive cards</p>
</div>
<div class="dashboard-actions">
    <a href="#createDeck" class="btn btn-gradient-primary" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="createDeck">
        <i class="fas fa-plus"></i> New Deck
    </a>
</div>
{% endblock %}

{% block content %}
<div class="row g-3">
    <div class="col-12">
        <form method="get" class="card dashboard-card mb-3 p-3">
            <div class="row g-2 align-items-end">
                <div class="col-md-4">
                    <label class="form-label">Search</label>
                    <input type="text" name="q" value="{{ query }}" class="form-control" placeholder="Search decks...">
                </div>
                <div class="col-md-4">
                    <label class="form-label">Category</label>
                    <select name="category" class="form-select">
                        <option value="">All Categories</option>
                        {% for value,label in form.category.field.choices %}
                            <option value="{{ value }}" {% if value == selected_category %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-4 d-flex gap-2">
                    <button type="submit" class="btn btn-gradient-primary flex-grow-1"><i class="fas fa-search"></i> Filter</button>
                    <a href="{% url 'flashcards:deck_list' %}" class="btn btn-outline-primary-soft"><i class="fas fa-undo"></i></a>
                </div>
            </div>
        </form>
    </div>
    <div class="col-12">
        <div id="createDeck" class="collapse">
            <div class="card dashboard-card mb-3">
                <div class="card-body">
                    <h5 class="card-title"><i class="fas fa-folder-plus"></i> Create a new deck</h5>
                    <form method="post" class="row g-3 mt-2">
                        {% csrf_token %}
                        <div class="col-md-6">
                            {{ form.title.label_tag }}
                            {{ form.title }}
                        </div>
                        <div class="col-md-12">
                            {{ form.description.label_tag }}
                            {{ form.description }}
                        </div>
                        <div class="col-12">
                            <button type="submit" class="btn btn-gradient-primary">
                                <i class="fas fa-save"></i> Create Deck
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    {% if decks %}
        {% for deck in decks %}
            <div class="col-md-6 col-lg-4">
                <div class="card dashboard-card h-100">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title mb-1">
                            <i class="fas fa-layer-group"></i> {{ deck.title }}
                        </h5>
                        <div class="mb-1"><span class="badge bg-primary-soft">{{ deck.get_category_display }}</span></div>
                        <p class="text-muted small mb-2">{{ deck.description|default:'No description' }}</p>
                        <p class="mb-4"><span class="badge bg-secondary-soft">{{ deck.cards_count }} cards</span></p>
                        <div class="mt-auto d-flex gap-2">
                            <a href="{% url 'flashcards:deck_detail' deck.pk %}" class="btn btn-outline-primary-soft w-100">
                                <i class="fas fa-edit"></i> Manage
                            </a>
                            <a href="{% url 'flashcards:study' deck.pk %}" class="btn btn-gradient-primary w-100">
                                <i class="fas fa-play"></i> Study
                            </a>
                            <a href="{% url 'flashcards:deck_edit' deck.pk %}" class="btn btn-outline-primary-soft"><i class="fas fa-pencil"></i></a>
                            <a href="{% url 'flashcards:deck_delete' deck.pk %}" class="btn btn-outline-danger"><i class="fas fa-trash"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    {% else %}
        <div class="col-12">
            <div class="card dashboard-card">
                <div class="card-body text-center py-5">
                    <i class="fas fa-layer-group empty-icon" style="font-size: 4rem;"></i>
                    <h5 class="text-muted">No decks yet</h5>
                    <p class="text-muted">Create your first deck to start studying.</p>
                    <a href="#createDeck" class="btn btn-gradient-primary" data-bs-toggle="collapse">
                        <i class="fas fa-plus"></i> New Deck
                    </a>
                </div>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}
