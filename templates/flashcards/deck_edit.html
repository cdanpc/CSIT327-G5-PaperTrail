{% extends 'base_dashboard.html' %}
{% load static %}

{% block title %}Edit Deck - {{ deck.title }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/flashcards.css' %}">
<link rel="stylesheet" href="{% static 'css/resources.css' %}?v=1.0">
{% endblock %}

{% block header %}
<div class="dashboard-title-section">
  <h1 class="dashboard-title">Flashcards</h1>
  <p class="dashboard-date">Update details for "{{ deck.title }}"</p>
</div>
<div class="dashboard-actions">
  <a href="{% url 'flashcards:deck_detail' deck.pk %}" class="btn btn-outline-primary-soft btn-pill"><i class="fas fa-arrow-left"></i> Back</a>
</div>
{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="card dashboard-card">
      <div class="card-body">
        <h5 class="card-title"><i class="fas fa-pencil"></i> Edit Deck</h5>
        <form method="post" class="mt-3" id="deckEditForm">
          {% csrf_token %}
          <div class="mb-3">{{ form.title.label_tag }}{{ form.title }}</div>
          <div class="mb-3">{{ form.description.label_tag }}{{ form.description }}</div>
          <div class="mb-3">{{ form.category.label_tag }}{{ form.category }}</div>
          <div class="mb-4">
            <h6 style="font-weight:700; color:#1a1a1a; margin-bottom:1rem; padding-bottom:.5rem; border-bottom:2px solid rgba(102,126,234,.1);">
              <i class="fas fa-lock" style="color:#667eea;"></i> Privacy Settings
            </h6>
            <div class="soft-panel">
              <div class="form-check form-switch" style="display:flex; align-items:center; gap:.5rem;">
                <input class="form-check-input" type="checkbox" id="deckVisibilityToggleEdit" {% if deck.visibility == 'public' %}checked{% endif %}>
                <label class="form-check-label" for="deckVisibilityToggleEdit" style="margin-left:.25rem; font-weight:600;">Make this deck public (visible to all students)</label>
              </div>
              <input type="hidden" name="visibility" id="deckVisibilityValueEdit" value="{{ deck.visibility }}">
              <div class="alert alert-info alert-soft-primary mt-3 mb-0">
                <i class="fas fa-info-circle"></i>
                <strong>Public:</strong> Appears in "All Decks" after verification (professor uploads verify immediately). <strong>Private:</strong> Only visible to you under "My Decks".
              </div>
            </div>
          </div>
          <button type="submit" class="btn btn-gradient-primary"><i class="fas fa-save"></i> Save Changes</button>
          <a href="{% url 'flashcards:deck_detail' deck.pk %}" class="btn btn-outline-primary-soft ms-2">Cancel</a>
        </form>
      </div>
    </div>
  </div>
</div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function(){
  const toggle = document.getElementById('deckVisibilityToggleEdit');
  const hidden = document.getElementById('deckVisibilityValueEdit');
  function sync(){ hidden.value = toggle.checked ? 'public' : 'private'; }
  toggle.addEventListener('change', sync); sync();
});
</script>
{% endblock %}
