{% extends 'base_dashboard.html' %}
{% load static %}
{% block title %}Study: {{ deck.title }}{% endblock %}
{% block page_title %}Flashcards{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/flashcards.css' %}">
<link rel="stylesheet" href="{% static 'css/resources.css' %}?v=1.0">
{% endblock %}
{% block content %}
<div class="fc-container fc-tight-top">
    <div class="mb-2 bookmarks-header-row"><a href="{% url 'flashcards:deck_detail' deck.pk %}" class="btn btn-outline-primary-soft btn-pill"><i class="fas fa-arrow-left"></i> Back</a></div>
    <div class="mb-3 d-flex justify-content-between align-items-center">
        <h1 class="fc-title mb-0">Study: {{ deck.title }}</h1>
        <div class="d-flex align-items-center gap-2">
            <button id="flipBtn" class="fc-btn fc-btn-outline" type="button"><i class="fas fa-sync"></i><span> Flip</span></button>
            <button id="prevBtn" class="fc-btn fc-btn-outline" type="button" disabled><i class="fas fa-chevron-left"></i></button>
            <button id="nextBtn" class="fc-btn fc-btn-primary" type="button"><i class="fas fa-chevron-right"></i><span> Next</span></button>
        </div>
    </div>
    <p class="text-muted small">Card <span id="cardIndex">1</span> / {{ total_cards }}</p>

    <div class="flashcard-container mb-4">
        <div class="flashcard" id="studyCard">
            <div class="flashcard-inner">
                <div class="flashcard-front"><div id="frontContent"></div></div>
                <div class="flashcard-back"><div id="backContent"></div></div>
            </div>
        </div>
    </div>
    
    
    <script>
        const cards = JSON.parse('{{ cards_json|escapejs }}');
        let idx = 0; let flipped = false;
        function render(){
            const c = cards[idx];
            document.getElementById('frontContent').textContent = c.front_text;
            document.getElementById('backContent').textContent = c.back_text;
            document.getElementById('cardIndex').textContent = idx+1;
            document.querySelector('.flashcard-inner').style.transform = flipped ? 'rotateY(180deg)' : 'none';
            document.getElementById('prevBtn').disabled = idx === 0;
        }
        document.getElementById('flipBtn').onclick = ()=>{ flipped = !flipped; render(); };
        document.getElementById('nextBtn').onclick = ()=>{ if(idx < cards.length-1){ idx++; flipped=false; render(); } };
        document.getElementById('prevBtn').onclick = ()=>{ if(idx>0){ idx--; flipped=false; render(); } };
        render();
    </script>
</div>
{% endblock %}
